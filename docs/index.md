# THUAI

## 1. 大赛概况

### 1.1. 本届赛题

#### 1.1.1. 名称

**未来战场**

#### 1.1.2. 背景

【科技与勇气交织的史诗】

在自动化系和软件学院学生科协精心策划的《未来战场》赛道中，你将作为一名英勇的战士，踏入这个充满挑战与机遇的战场。在这个高度自动化的近未来世界中，战争已经演变为无人化、智能化的较量。你置身于现实与虚拟的交汇点，操控着先进的无人作战系统，与来自世界各地的对手展开激烈的角逐。

你肩负着守护家园的重任，需要充分发挥智慧和勇气，运用各种高科技装备，制定出精妙的战略和战术。你编写的无人作战系统将成为得力助手，它们具备高度自主性和智能化能力，能够在战场上独当一面。然而战场危机四伏，敌人猛烈的攻击如狂风暴雨，网络病毒的侵袭更似幽灵潜行。你需要步步为营，智勇并举，才能在这场未来战争中披荆斩棘，报效家国。

每一次胜利，都是你为国家荣誉而战斗的见证；每一分成绩，都是你为国家利益而努力的回报。在这场近未来无人化战争的舞台上，你将用自己的智慧和勇气，书写下激励人心的英雄篇章！让我们共同为国家的繁荣和强大而努力，展现出新时代青年的风采与担当！

### 1.2. 参赛流程

#### 1.2.1. 大赛日程

复赛时间为 2024 年 5 月 12 日，决赛时间为 5 月 26 日。选手需要在复赛时间内在网站提交代码。

#### 1.2.2. 报名方法

**【报名问卷】** 请填写如下问卷 [https://wj.qq.com/s2/14528984/c7b2/](https://wj.qq.com/s2/14528984/c7b2/) ，并加入比赛选手群。问卷填写完成且有效则视为参赛。

【关于组队】

选手可在报名网站自行组队，每队**不超过3人**，组队截止时间与报名截止时间相同。

### 1.3. 奖励办法

| 奖项  |  预计奖金(元) |
| :---: | :---: |
| 特等奖 |   8000    |
| 一等奖 |   5000    |
| 二等奖 |   3000    |
| 三等奖 |    1000   |

注：该奖励只对于自动化系和软件学院承办的“未来战场”赛道，奖励的最终解释权归主办方所有。

## 2. 比赛规则

### 2.1. 比赛流程

每场比赛均由**两支队伍**展开激烈对战，即场上仅存在两个无人作战系统。

#### 2.1.1. 比赛开始前

地图上会随机分布各种资源，包括武器、弹药、护甲、药品和手榴弹。选手们需要在比赛开始前的准备时刻通过代码预先设定好起始位置，以便在比赛开始时迅速进入战斗状态。

#### 2.1.2. 比赛过程中

比赛开始后，选手们需要通过智能算法控制无人作战系统在地图上移动，寻找并收集这些资源，以提升自身的战斗力。同时，选手们可以对其他队伍的无人作战系统发起攻击，争夺优势。

地图上会有一个不断缩小的安全区，安全区外的区域会受到网络病毒的影响。选手在安全区外每秒会受到伤害，因此需要时刻注意安全区的变化，避免被病毒侵蚀。同时，安全区的缩小也会迫使选手们逐渐靠近，增加战斗的频率和激烈程度。

#### 2.1.3. 结束条件

比赛持续到只剩下最后一个无人作战系统存活，该系统所属的队伍即为胜利者。如果在规定的时间内，所有队伍的无人作战系统都已全部被淘汰，那么存活时间最长的队伍将获胜。

关于比赛的更多细节与规则，请参见下文。

### 2.2. 细节规则

#### 2.2.1. 帧数

比赛以每秒 20 ticks（即20次更新）的速度进行。

#### 2.2.2. 地图

大小为 256m * 256m 的平面，由 256 * 256 个边长为 1m 的方格构成，每个方格的中心位置可表示为 $(a + 0.5, b + 0.5)$ ， $a，b$ 为整数。地图上随机分布有墙体和资源。墙体能抵挡部分攻击，为玩家提供庇护；资源不会刷新，可供选手收集以增强自身实力。选手需巧妙利用地形与资源，展开激烈的较量。

地图上弥漫着网络病毒，[安全区](#安全区)会不断缩小。

##### 2.2.2.1. 墙体

由棱长为1m的正方体组成，可以抵挡部分攻击，墙体**不可被破坏**。

![Walls.jpg](images\Walls.jpg)

上图展示了地图中墙体的示意图，这些墙体是根据一定的规则生成的，其形状固定而位置随机。这些墙体的生成是通过特定的代码实现的，你可以通过以下链接查看生成形状的代码：[thuai-7/server/src/GameServer/GameLogic/Map/Map.Buildings.cs at main · thuasta/thuai-7 · GitHub](https://github.com/thuasta/thuai-7/blob/main/server/src/GameServer/GameLogic/Map/Map.Buildings.cs) 

##### 2.2.2.2. 安全区

安全区是一个初始半径为256m的圆形区域，其面积会随着时间的推移逐渐减小，5min后消失。安全区的圆心会随机移动，选手需要时刻关注安全区的位置，以避免受到网络病毒的伤害。在安全区外，选手每秒会受到20点真实伤害（每tick受到1点伤害），因此必须尽快进入安全区。以下是安全区示意图，红色粒子效果内较明亮区域为安全区。

![Circle.jpg](images\Circle.jpg)

#### 2.2.3. 资源

地图上分布的资源类型，资源的位置是随机的**整数**，分布在地图的方格中，且玩家可以捡起同一方格内所有资源。但资源的种类和数量是固定的。两次捡起资源的最小间隔为3 ticks。

资源包括护甲、绷带、急救箱、激光枪、弹药、手榴弹。选手需要在地图上寻找和拾取这些资源，以提升自身的战斗力。具体而言，地图会生成 256 个资源，每个资源是上述资源中的一种，且刷新概率相等，它们的信息如下：


| 名称  | 作用                                                                                   | 占用背包容量 | 每个资源刷新数量区间 |
|:---:| ------------------------------------------------------------------------------------ |:------:| :------: |
| 护甲  | 为玩家提供额外血量。玩家受到攻击时，优先扣除护甲血量。护甲无法抵挡病毒造成的伤害。护甲血量不会自动恢复。<br>低级护甲：额外血量50 <br>高级护甲：额外血量100 | 0      | 1 |
| 绷带  | 恢复10点血量                                                                               | 2      | [1,4] |
| 急救箱 | 恢复75点血量                                                                   | 10     | [1,4] |
| 激光枪 | 瞬间发射，可对其他选手造成伤害；无法穿透墙体；需要消耗弹药。具体数值请参见[武器](#武器)                                       | 0      | 1 |
| 弹药  | 所有种类激光枪发射消耗同一种弹药                                                                     | 1      | 仅和武器一起刷新，其中 S686 为 8 发，M16 为 16 发，VECTOR 为 16 发，AWM 为 4 发 |
| 手榴弹 | 可在半径60m距离内投掷，能够越过墙体。投掷后5s爆炸，爆炸半径10m，且对范围内所有选手均造成伤害，距离投掷中心越近伤害越高。伤害不会穿过墙体。伤害计算：手榴弹会发出若干射线，射线伤害值随着距离线性递减，并且玩家距离爆炸点越近，被击中的射线数量也越多。手榴弹的使用需要谨慎，合理的投掷位置和时机能够最大化其威力，为战局带来重要影响。两次扔出手榴弹的间隔为20 ticks。                       | 15     | [1,4] |

> 具体而言，设 x 为玩家与爆炸中心距离，手雷伤害计算公式大致如下。代码细节见 [thuai-7/server/src/GameServer/GameLogic/Grenade.cs at main · thuasta/thuai-7 · GitHub](https://github.com/thuasta/thuai-7/blob/9fbe355bf2ddfd58954d26a81ddeca1a57e68fce/server/src/GameServer/GameLogic/Grenade.cs#L39)

$$
\begin{equation}
\begin{aligned}
Damage(x)=\left\{
	\begin{aligned}
	1690-169x & \quad 0<x<0.5\\
	\frac{2}{\pi}\cdot (1690-169x)\arcsin (\frac{1}{2x}) & \quad 0.5<x<10 \\
 	0 & \quad x>10
	\end{aligned}
	\right.
\end{aligned}
\end{equation}
$$

<a id="武器"></a>

#### 2.2.4. 武器

未持有武器时，攻击即拳击的距离为1m，伤害为18.

| 武器        | 攻击距离 | 裸伤害 | CD（攻击间隔） | 其他                                   |
|:---------:| ---- | --- | -------- | ------------------------------------ |
| 霰弹枪S686   | 37m  | 26 * 9  | 28 ticks  | 一次可向前方24度扇形区域发射9束激光 |
| 冲锋枪vector | 35m  | 31  | 3 ticks   |                                      |
| 步枪M16     | 90m | 43  | 8 ticks  |                                      |
| 狙击枪AWM    | 94.5m | 105 | 55 ticks |                                      |

CD 说明：武器的两次攻击之间存在CD。CD是武器的属性，除攻击之外的任何操作都不会对武器的CD产生影响。

#### 2.2.5. 选手

无人作战系统具有以下属性：

- 物理实体：直径1米的圆柱体。
  > 仅限于受击判定。移动时视为质点。

- 生命值：200点，生命值耗尽后无人作战系统被淘汰。

- 速度：每秒5米。

- 出生点选择：游戏开始的前 200 tick 内为准备时间，游戏逻辑不会更新，选手攻击、移动、拾取等操作均不生效。选手此时可以根据地图信息在地图范围内选择一个出生点，之后无法更改。若出生点不合法（例如在墙体上）或选手没有选择，则会被系统随机分配一个合法的出生点。

- 移动：选手给出目的地坐标后，沿直线前进；运动过程中若碰到墙体则停止（若希望继续移动需重新选择目的地）
  > 建议选手选择距无人作战系统较远（至少大于0.02m）的位置作为目的地，否则可能因距离过短导致系统认为已到达目的地。
  
- 背包容量：100个单位空间，用于存放收集到的资源。

- 拾取：选手可以拾取 **当前脚下 1×1 方格上** 的资源，若背包容量充足，资源会直接放入背包，拾取后资源消失。
  > 如何得到当前脚下是哪一块方格呢？选手可以通过 SDK 获取自己当前的位置，然后将其向下取整即可得到当前脚下方格的坐标。

- 攻击：无武器时拳击。可拾取至多两把 __不同类型__ 的武器（例如当无人作战系统已拾取 `AWM`, 则不能再拾取地图上的其他 `AWM`）
  > 选手应避免目标位置和无人作战系统自身位置重合，否则无人作战系统将因无法辨认目标方位而浪费子弹，

- 视野：无人作战系统可以获取地图上的所有信息，包括其他选手的位置、状态和资源分布。
  > 不能获取已掷出的手雷位置，因此无人作战系统需要自主判断地图上可能存在的手雷。

- 无人作战系统所有操作都是按请求结算，即无人作战系统每发起一次请求都会【立即】结算。一帧内可以进行任意多次操作。

### 2.3. 源码仓库

更多细节请关注科协仓库：[https://github.com/thuasta/thuai-7/tree/main](https://github.com/thuasta/thuai-7/tree/main)

## 3. 选手代码实现要求

### 3.1. 总述

选手需要写出一个完整的程序(Agent)，能够完成下列基本操作，并根据战场形势决定最优策略。选手的所有逻辑包括条件判断、动态的检测与决策等）都必须在代码中完成，一旦开始对战就无法通过任何形式（如命令行）改变逻辑或手动输入命令。选手最终提交一个或多个文件（若选择使用[接口](#32-接口调用说明)，则为相应的.cpp 或 .py文件），其中必须包括所有的代码。

基本操作：选择出生地；移动 / 停止；拾取 / 丢弃资源；攻击；使用药品；使用手榴弹；获取战场信息。

### 3.2. 接口调用说明

选手的代码需要通过预定义的API与比赛服务器进行交互，请点击页面左方查看 [Python SDK 文档](python_sdk.md) 或 [C++ SDK 文档](C++_sdk.md)。

## 4. 赛制说明

### 4.1. 初赛赛制

To be continued...

### 4.2. 决赛赛制

To be continued...
